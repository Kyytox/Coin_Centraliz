{% extends 'news/base.html' %}
{% load static %}


{%block content%}

<div id="main">
    <div class="main-creator">
        <form action="{% url 'index' %}">
            <button type="submit" {% if site.title in request.get_full_path %} id="active" {% endif %}>Dernieres Actus</button>
        </form>
        {% for site in list_site_articles %}
        <form action="{% url 'index' %}" method="GET">
            <input type="hidden" name="r" value="{{ site.title }}">
            <button type="submit" {% if site.title in request.get_full_path %} id="active" {% endif %}>{{ site.title }} </button>
        </form>
    {% endfor %}
    </div>

    <div class="main-data-box" id="main-data">
        <div class="disposition">
            <i id="dispo_list" onclick="dispo_list()" class="fa-solid fa-list"></i>
            <i id="dispo_box" onclick="dispo_box()" class="fa-solid fa-table-cells-large"></i>
        </div>
        {% include "news/box_article.html"%}
    </div>

    <div class="main-div-descr" id="main-div-descr" style="display:none" >
        {% include "news/box_descr_article.html"%}
    </div>
</div>

<script>

    AOS.init({
        delay: 300, // values from 0 to 3000, with step 50ms
        duration: 800, // values from 0 to 3000, with step 50ms     
    });

    function dispo_box() {
        document.getElementById("main-data").classList.replace("main-data", "main-data-box");
        document.getElementById("main-div-descr").style.display = "none";
    }

    function dispo_list() {
        document.getElementById("main-data").classList.replace("main-data-box", "main-data");
        document.getElementById("main-div-descr").style.display = "block";
    }

    // Hiden principal scroll br of the page 
    var style = document.createElement("style");
    style.innerHTML = `body::-webkit-scrollbar {display: none;}`;
    document.head.appendChild(style);

    {% comment %} document.addEventListener('DOMContentLoaded', function() {
        console.log('HTML prêt !');
    }); {% endcomment %}

    function createOnLoad(author, site, category_1, category_2, category_3, category_4, date_publi, url) {

        var classname = document.getElementById("div-description-create");
        //console.log("classname :",classname);

        var article_title = document.getElementById("article-title-" + url);
        //console.log("article_title :",article_title.textContent);

        var description_article = document.getElementById("article-" + article_title.textContent);
        //console.log("description_article :",description_article.textContent);

        if (classname == null){

            // crée un nouvel élément ul
            var newDiv = document.createElement("div");
            newDiv.setAttribute("id", "div-description-create");


            // crée un nouvel élément div description 
            let div_article_description = document.createElement('div');
            div_article_description.setAttribute("id", "div-description");
            // ajoute le nœud texte au nouveau div-description-create
            newDiv.appendChild(div_article_description);

            // crée un nouvel élément div title 
            let div_title = document.createElement('div');
            div_title.setAttribute("id", "div-description-title");

            var a_title = document.createElement('a');
            var linkText_new_article = document.createTextNode(article_title.textContent);
            a_title.appendChild(linkText_new_article);
            a_title.title = "title";
            a_title.href = url;
            div_title.appendChild(a_title);

            // ajoute le nœud texte au nouveau div-description-create
            div_article_description.appendChild(div_title);


            // crée un nouvel élément div date_publi 
            let div_date_publi = document.createElement('div');
            div_date_publi.setAttribute("id", "div-description-date-publi");
            div_date_publi.textContent = date_publi;
            // ajoute le nœud texte au nouveau div-description-create
            div_article_description.appendChild(div_date_publi);


            // crée un nouvel élément div url 
            let div_url = document.createElement('div');
            div_url.setAttribute("id", "div-description-url");

            var a = document.createElement('a');
            var linkText_title = document.createTextNode(url);
            a.appendChild(linkText_title);
            a.title = "url";
            a.href = url;
            div_url.appendChild(a);

            // ajoute le nœud texte au nouveau div-description-create
            div_article_description.appendChild(div_url);


            // crée un nouvel élément div site 
            let div_site = document.createElement('div');
            div_site.setAttribute("id", "div-description-site");
            div_site.textContent = site;
            // ajoute le nœud texte au nouveau div-description-create
            div_article_description.appendChild(div_site);


            // crée un nouvel élément div author 
            let div_author = document.createElement('div');
            div_author.setAttribute("id", "div-description-author");
            div_author.textContent = 'Auteur : ' + author;
            // ajoute le nœud texte au nouveau div-description-create
            div_article_description.appendChild(div_author);


            // crée un nouvel élément div category 
            let div_category = document.createElement('div');
            div_category.setAttribute("id", "div-description-categories");
            div_category.textContent = category_1 + '   ' + category_2 + '   ' + category_3 + '   ' + category_4;
            // ajoute le nœud texte au nouveau div-description-create
            div_article_description.appendChild(div_category);



            // crée un nouvel élément div description 
            let div_description = document.createElement('div');
            div_description.setAttribute("id", "div-description-description");
            div_description.textContent = description_article.textContent;
            // ajoute le nœud texte au nouveau div-description-create
            div_article_description.appendChild(div_description);


            console.log(newDiv)
            // ajoute le nouvel élément créé et son contenu dans le DOM
            //var currentDiv = document.getElementById("derniers-media");
            //document.body.insertBefore(newDiv, currentDiv);

            originalDiv = document.getElementById("derniers-media");
            var parentDiv = document.getElementById("main");
            parentDiv.insertBefore(newDiv, originalDiv);

        }
    }


    

    function createDescriptionArticle(author, site, category_1, category_2, category_3, category_4, date_publi, url) {

        var classname = document.getElementById("div-description-create");
        //console.log("classname :",classname);

        var article_title = document.getElementById("article-title-" + url);
        //console.log("article_title :",article_title.textContent);

        var description_article = document.getElementById("article-" + article_title.textContent);
        //console.log("description_article :",description_article.textContent);

        if (classname == null){

            // crée un nouvel élément ul
            var newDiv = document.createElement("div");
            newDiv.setAttribute("id", "div-description-create");


            // crée un nouvel élément div description 
            let div_article_description = document.createElement('div');
            div_article_description.setAttribute("id", "div-description");
            // ajoute le nœud texte au nouveau div-description-create
            newDiv.appendChild(div_article_description);


            // crée un nouvel élément div date_publi 
            let div_date_publi = document.createElement('div');
            div_date_publi.setAttribute("id", "div-description-date-publi");
            div_date_publi.textContent = date_publi;
            // ajoute le nœud texte au nouveau div-description-create
            div_article_description.appendChild(div_date_publi);


            // crée un nouvel élément div title 
            let div_title = document.createElement('div');
            div_title.setAttribute("id", "div-description-title");
            var a_title = document.createElement('a');
            var linkText_new_article = document.createTextNode(article_title.textContent);
            a_title.appendChild(linkText_new_article);
            a_title.title = "title";
            a_title.href = url;
            div_title.appendChild(a_title);
            // ajoute le nœud texte au nouveau div-description-create
            div_article_description.appendChild(div_title);



            // crée un nouvel élément div url 
            let div_url = document.createElement('div');
            div_url.setAttribute("id", "div-description-url");
            var a = document.createElement('a');
            var linkText_title = document.createTextNode(url);
            a.appendChild(linkText_title);
            a.title = "url";
            a.href = url;
            div_url.appendChild(a);
            // ajoute le nœud texte au nouveau div-description-create
            div_article_description.appendChild(div_url);


            // crée un nouvel élément div site 
            let div_site = document.createElement('div');
            div_site.setAttribute("id", "div-description-site");
            div_site.textContent = site;
            // ajoute le nœud texte au nouveau div-description-create
            div_article_description.appendChild(div_site);


            // crée un nouvel élément div author 
            let div_author = document.createElement('div');
            div_author.setAttribute("id", "div-description-author");
            div_author.textContent = 'Auteur : ' + author;
            // ajoute le nœud texte au nouveau div-description-create
            div_article_description.appendChild(div_author);


            // crée un nouvel élément div category 
            let div_category = document.createElement('div');
            div_category.setAttribute("id", "div-description-categories");
            div_category.textContent = category_1 + '   ' + category_2 + '   ' + category_3 + '   ' + category_4;
            // ajoute le nœud texte au nouveau div-description-create
            div_article_description.appendChild(div_category);



            // crée un nouvel élément div description 
            let div_description = document.createElement('div');
            div_description.setAttribute("id", "div-description-description");
            div_description.textContent = description_article.textContent;
            // ajoute le nœud texte au nouveau div-description-create
            div_article_description.appendChild(div_description);


            console.log(newDiv)
            // ajoute le nouvel élément créé et son contenu dans le DOM
            //var currentDiv = document.getElementById("derniers-media");
            //document.body.insertBefore(newDiv, currentDiv);

            originalDiv = document.getElementById("derniers-media");
            var parentDiv = document.getElementById("main");
            parentDiv.insertBefore(newDiv, originalDiv);

        }else{
            let new_div = document.getElementById("div-description-create");

            // crée un nouvel élément div description 
            let div_article_description = document.createElement('div');
            div_article_description.setAttribute("id", "div-description");
            

            // crée un nouvel élément div date_publi 
            let div_date_publi = document.createElement('div');
            div_date_publi.setAttribute("id", "div-description-date-publi");
            div_date_publi.textContent = date_publi;
            // ajoute le nœud texte au nouveau div-description-create
            div_article_description.appendChild(div_date_publi);



            // crée un nouvel élément div title 
            let div_title = document.createElement('div');
            div_title.setAttribute("id", "div-description-title");
            var a_title = document.createElement('a');
            var linkText_new_article = document.createTextNode(article_title.textContent);
            a_title.appendChild(linkText_new_article);
            a_title.title = "title";
            a_title.href = url;
            div_title.appendChild(a_title);
            // ajoute le nœud texte au nouveau div-description-create
            div_article_description.appendChild(div_title);


            // crée un nouvel élément div url 
            let div_url = document.createElement('div');
            div_url.setAttribute("id", "div-description-url");
            var a_url = document.createElement('a');
            var linkText_new_url = document.createTextNode(url);
            a_url.appendChild(linkText_new_url);
            a_url.title = "url";
            a_url.href = url;
            div_url.appendChild(a_url);
            // ajoute le nœud texte au nouveau div-description-create
            div_article_description.appendChild(div_url);


            // crée un nouvel élément div site 
            let div_site = document.createElement('div');
            div_site.setAttribute("id", "div-description-site");
            div_site.textContent = site;
            // ajoute le nœud texte au nouveau div-description-create
            div_article_description.appendChild(div_site);


            // crée un nouvel élément div author 
            let div_author = document.createElement('div');
            div_author.setAttribute("id", "div-description-author");
            div_author.textContent = 'Auteur : ' + author;
            // ajoute le nœud texte au nouveau div-description-create
            div_article_description.appendChild(div_author);


            // crée un nouvel élément div category 
            let div_category = document.createElement('div');
            div_category.setAttribute("id", "div-description-categories");
            div_category.textContent = category_1 + '   ' + category_2 + '   ' + category_3 + '   ' + category_4;
            // ajoute le nœud texte au nouveau div-description-create
            div_article_description.appendChild(div_category);


            // crée un nouvel élément div description 
            let div_description = document.createElement('div');
            div_description.setAttribute("id", "div-description-description");
            div_description.textContent = description_article.textContent;
            // ajoute le nœud texte au nouveau div-description-create
            div_article_description.appendChild(div_description);
            

            console.log('replaceChild')
            // replace the first list item
            new_div.replaceChild(div_article_description, new_div.firstElementChild);
        }
    }
</script>

{%endblock%}





